FROM rust:latest

# Install dependencies
RUN apt-get update && apt-get install -y \
    libpq-dev \
    && rm -rf /var/lib/apt/lists/*

# Install cargo-watch for hot reload
RUN cargo install cargo-watch

WORKDIR /app

# The source will be mounted as a volume
# No need to copy or build here - cargo-watch will handle it

EXPOSE 3000

# Default command (can be overridden)
CMD ["cargo", "watch", "-x", "run --package ramekin-server"]
